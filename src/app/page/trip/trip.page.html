<ion-header>
    <ion-toolbar color="primary">
        <ion-buttons slot="start">
            <ion-menu-button color="secondary">
            </ion-menu-button>
        </ion-buttons>
        <ion-title>
            {{strings.getString("trips_txt")}}
        </ion-title>
        <ion-buttons slot="end">
            <ion-button (click)="refreshTripsView()">
                <ion-icon slot="icon-only" class="secondary" name="refresh">
                </ion-icon>
            </ion-button>
        </ion-buttons>
    </ion-toolbar>
    <ion-searchbar
            showCancelButton="focus"
            placeholder="{{strings.getString('trip_search_hint')}}"
            debounce="500"
            (input)="onInput($event)"
            (search)="onInput($event,true)"
            (clear)="onClear($event)"
            (cancel)="onClear($event)"
            [animated]="true"
            [(ngModel)]="searchText">
    </ion-searchbar>
</ion-header>

<ion-content class="ion-padding">

    <!--Refresher -->
    <ion-refresher
            slot="fixed"
            [pullMin]="80"
            (ionRefresh)="refreshTripsView($event)"
            slot="fixed">
        <ion-refresher-content
                [pullingText]="strings.getString('pull_refresh_txt')"
                [refreshingText]="strings.getString('refreshing_txt')"
                [refreshingSpinner]="'circles'">
        </ion-refresher-content>
    </ion-refresher>

    <!--Loading view - Show if Trips hasn't been loaded yet-->
    <div class="loader cell" *ngIf="currentTrips==null">
        <ion-img [src]="assets.getPath('loading_page')"> </ion-img>
        <ion-label class="cell-content">{{strings.getString('loading_txt')}}</ion-label>
    </div>

    <!--No trip view - Show if currentTrips has been loaded but is empty-->
    <div class="loader cell" *ngIf="currentTrips!=null && currentTrips.length <= 0">
        <img src="{{assets.getPath('not_found')}}"/>
        <ion-label class="cell-content">{{strings.getString('no_trip_txt')}}</ion-label>
    </div>

    <!--Trip list-->
    <div id="dashCards" *ngIf="currentTrips!=null && currentTrips.length > 0">
        <ion-grid>
            <ion-row>
                <ion-col size="12" size-md="6" size-xl="4" *ngFor="let trip of currentTrips; let i = index" [attr.index]="i">
                    <ion-card>
                        <ion-card-header>
                            <ion-row>
                                <ion-col size="6" class="cell cell-flex cell-flex-left">
                                    <div class="cell cell-center cell-flex cell-flex-center {{getTripStatusClass(trip.status_id)}}">{{trip.status}}</div>
                                </ion-col>
                                <ion-col size="6" class="cell cell-flex cell-flex-right">
                                    <ion-label class="cell-content cell-right">{{trip.date + " " +trip.time }}</ion-label>
                                </ion-col>
                            </ion-row>
                        </ion-card-header>
                        <ion-card-content>
                            <ion-row>
                                <ion-col size-sm="8" size="12">
                                    <div class="cell cell-center">
                                        <div>
                                            <ion-label class="cell-content">{{trip.pickup_loc_name}}</ion-label>
                                        </div>
                                        <div>
                                            <ion-label class="cell-sub">{{trip.pickup_city}}</ion-label>
                                        </div>
                                    </div>

                                    <div class="cell-flex cell-flex-center">
                                        <ion-icon class="cell cell-center" name="arrow-round-down"> </ion-icon>
                                    </div>
                                    <div class="cell cell-center">
                                        <div>
                                            <ion-label class="cell-content">{{trip.dropoff_loc_name}}</ion-label>
                                        </div>
                                        <div>
                                            <ion-label class="cell-sub">{{trip.dropoff_city}}</ion-label>
                                        </div>
                                    </div>
                                </ion-col>
                                <ion-col size-sm="4" size="12" class="cell cell-center  cell-flex cell-flex-center ">
                                    <div>
                                        <div class="cell cell-center ">
                                            <ion-label class="cell-title">{{strings.getString("price_txt")}}</ion-label>
                                            <h4 class="cell-content">{{trip.currency_code}} {{trip.price}}</h4>
                                        </div>
                                        <br>
                                        <div class="cell cell-center ">
                                            <ion-button color="primary" (click)="showTrip(trip)">
                                                <ion-icon name="open" slot="start"></ion-icon>
                                                {{strings.getString("view_txt")}}
                                            </ion-button>
                                        </div>
                                    </div>
                                </ion-col>
                            </ion-row>
                            <div class="cell cell-center " *ngIf="trip.bus==null">
                                <ion-label class="cell-content danger x-small-text">{{strings.getString("no_bus_msg")}}
                                </ion-label>
                            </div>
                        </ion-card-content>
                    </ion-card>
                </ion-col>
            </ion-row>
        </ion-grid>
    </div>
    <br><br><br>
    <ion-fab *ngIf="statusList!=null && locationTypes!=null && busTypes!=null && ticketTypes!=null" vertical="bottom" horizontal="end" slot="fixed">
        <ion-fab-button (click)="showAddTrip()">
            <ion-icon name="add"> </ion-icon>
        </ion-fab-button>
    </ion-fab>
</ion-content>
