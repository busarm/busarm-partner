<ion-header>
  <ion-toolbar color="trasparent">
    <ion-title *ngIf="booking!=null">{{booking.booking_id}}</ion-title>
    <ion-title *ngIf="booking==null">{{strings.getString("bookings_txt")}}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">
        <ion-icon slot="icon-only" class="secondary" name="close"> </ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content class="ion-padding">
    <!--Booking info Card - Show if booking info has successfully loaded -->
    <ion-card id="bookingCard" *ngIf="booking!=null">
        <ion-card-header>
            <ion-row>
                <ion-col size="4" class="cell cell-center cell-flex cell-flex-left">
                    <div class="cell cell-center  cell-flex cell-flex-center  {{getBookingStatusClass(booking.status_id)}}">
                        {{booking.status}}
                    </div>
                </ion-col>
                <ion-col size="8" class="cell cell-right cell-flex cell-flex-right">
                    <ion-label class="cell-content">{{booking.booking_date + " " +booking.booking_time }}
                    </ion-label>
                </ion-col>
            </ion-row>
        </ion-card-header>
        <ion-card-content class="ion-padding">
            <div class="cell-margin-top-2x">
                <ion-segment [(ngModel)]="activeBookingSegment">
                    <ion-segment-button [value]="'summary'" class="cell cell-center cell-flex cell-flex-center ">
                        {{strings.getString('summary_txt')}}
                    </ion-segment-button>
                    <ion-segment-button [value]="'trip'" class="cell cell-center  cell-flex cell-flex-center ">
                        {{strings.getString('trip_txt')}}
                    </ion-segment-button>
                    <ion-segment-button [value]="'ticket'" class="cell cell-center  cell-flex cell-flex-center ">
                        {{strings.getString('ticket_txt')}}
                    </ion-segment-button>
                </ion-segment>
            </div>
            <div [ngSwitch]="activeBookingSegment">
                <ion-row *ngSwitchCase="'summary'">
                    <ion-col size="12">
                        <ion-label class="cell cell-center ">
                            <div class="cell-title">{{strings.getString('name_txt')}}</div>
                            <div class="cell-content">{{booking.user_name}}</div>
                        </ion-label>
                        <ion-label class="cell cell-center ">
                            <div class="cell-title">{{strings.getString('payment_type')}}</div>
                            <div class="cell-content">{{booking.payment_type}}</div>
                        </ion-label>
                    </ion-col>
                </ion-row>
                <ion-row *ngSwitchCase="'trip'">
                    <ion-col size="12" class="cell cell-center cell-flex cell-flex-center">
                        <ion-button color="primary" (click)="showTrip(booking.trip)">
                            <ion-icon slot="start" name="open"> </ion-icon>
                            {{strings.getString("view_txt")}}
                        </ion-button>
                    </ion-col>
                    <ion-col size="12">
                        <ion-label class="cell cell-center ">
                            <div class="cell-title">{{strings.getString('from_txt')}}</div>
                            <div class="cell-content">{{booking.pickup_location ? booking.pickup_location.loc_name : booking.trip.pickup_loc_name}}</div>
                            <div class="cell-sub">{{booking.pickup_location ? booking.pickup_location.loc_address : booking.trip.pickup_loc_address}}</div>
                            <div class="cell-sub">{{booking.pickup_location ? booking.pickup_location.city_name : booking.trip.pickup_city}}</div>
                        </ion-label>
                        <ion-label class="cell cell-center ">
                            <div class="cell-title">{{strings.getString('to_txt')}}</div>
                            <div class="cell-content">{{booking.dropoff_location ? booking.dropoff_location.loc_name : booking.trip.dropoff_loc_name}}</div>
                            <div class="cell-sub">{{booking.dropoff_location ? booking.dropoff_location.loc_address : booking.trip.dropoff_loc_address}}</div>
                            <div class="cell-sub">{{booking.dropoff_location ? booking.dropoff_location.city_name : booking.trip.dropoff_city}}</div>
                        </ion-label>
                        <ion-label class="cell cell-center ">
                            <div class="cell-title">{{strings.getString('departure_date_txt')}}</div>
                            <div class="cell-content">{{booking.trip.date}}</div>
                        </ion-label>
                        <ion-label class="cell cell-center ">
                            <div class="cell-title">{{strings.getString('departure_time_txt')}}</div>
                            <div class="cell-content">{{booking.trip.time}}</div>
                        </ion-label>
                    </ion-col>
                </ion-row>
                <ion-row *ngSwitchCase="'ticket'">
                    <ion-col size="12" class="cell cell-center">
                        <ion-list>
                            <ion-row class="cell cell-center ">
                                <ion-col class="cell cell-center  cell-flex cell-flex-center ">
                                    <ion-label class="cell-title">{{strings.getString('type_txt')}}</ion-label>
                                </ion-col>
                                <ion-col class="cell cell-center  cell-flex cell-flex-center ">
                                    <ion-label class="cell-title">{{strings.getString('qty_txt')}}</ion-label>
                                </ion-col>
                                <ion-col class="cell cell-center  cell-flex cell-flex-center ">
                                    <ion-label class="cell-title">{{strings.getString('unit_price_txt')}}</ion-label>
                                </ion-col>
                                <ion-col class="cell cell-center  cell-flex cell-flex-center ">
                                    <ion-label class="cell-title">{{strings.getString('amount_txt')}}</ion-label>
                                </ion-col>
                            </ion-row>
                            <ion-row *ngFor="let ticket of booking.tickets; let i = index" [attr.index]="i">
                                <ion-col class="cell cell-center  cell-flex cell-flex-center ">
                                    <ion-label class="cell-content">{{ticket.name}}</ion-label>
                                </ion-col>
                                <ion-col class="cell cell-center  cell-flex cell-flex-center ">
                                    <ion-label class="cell-content">{{ticket.qty}}</ion-label>
                                </ion-col>
                                <ion-col class="cell cell-center  cell-flex cell-flex-center ">
                                    <ion-label class="cell-content">{{ticket.currency_code}} {{ticket.price}}</ion-label>
                                </ion-col>
                                <ion-col class="cell cell-center  cell-flex cell-flex-center ">
                                    <ion-label class="cell-content">{{ticket.currency_code}} {{ticket.amount}}</ion-label>
                                </ion-col>
                            </ion-row>
                        </ion-list>
                    </ion-col>
                    <ion-col size="12" class="cell cell-center">
                        <ion-label class="cell cell-center">
                            <div class="cell-title">{{strings.getString('seats_txt')}}</div>
                            <div class="cell-content">{{getBookingSeatsText(booking.seats)}}</div>
                        </ion-label>
                    </ion-col>
                </ion-row>
            </div>
            <div>
                <ion-label class="cell cell-center ">
                    <div class="cell-title">{{strings.getString('sub_total_txt')}}</div>
                    <div class="cell-content">{{booking.currency_code}} {{booking.sub_total}}</div>
                </ion-label>
                <ion-label class="cell cell-center ">
                    <div class="cell-title">{{strings.getString('booking_fee_txt')}}</div>
                    <div class="cell-content">{{booking.currency_code}} {{booking.booking_fee}}</div>
                </ion-label>
                <ion-label class="cell cell-center ">
                    <div class="cell-title">{{strings.getString('total_txt')}}</div>
                    <h3 class="cell-content">{{booking.currency_code}} {{booking.total}}</h3>
                </ion-label>
            </div>
            <div class="cell cell-center ">
                <ion-button [hidden]="booking.status_id=='9' || booking.status_id=='11'" expand="block" class="ok" (click)="confirmVerify()">
                    {{strings.getString("verify_booking_txt")}}
                </ion-button>
            </div>
        </ion-card-content>
    </ion-card>
</ion-content>
